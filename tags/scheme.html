<!DOCTYPE html><html><head><meta charset="utf-8" /><title>I do robots</title><link href="../style/bootstrap.min.css" rel="stylesheet" type="text/css" /><link href="../style/font-awesome.min.css" rel="stylesheet" type="text/css" /><link href="../style/ts.theme.dark.css" rel="stylesheet" type="text/css" /><link href="../style/hljs.theme.hybrid.css" rel="stylesheet" type="text/css" /><link href="../style/blog.css" rel="stylesheet" type="text/css" /><link href="../index.xml" rel="alternate" title="I do robots Feed" type /><link href="../media/favicon.ico" rel="icon" type="image/png" /><script src="../js/jquery-2.2.0.min.js" type="text/javascript"></script><script src="../js/jquery.tablesorter.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/highlight.min.js" type="text/javascript"></script><script src="../js/blog.js" type="text/javascript"></script><meta content="width=device-width, initial-scale=1.0" name="viewport" /><meta content="λ-blog v.1.3.2" name="generator" /><meta content="Idorobots" name="author" /><meta content="Kajetan Rzepecki, Idorobots, dev-blog, devblog, blog, Clojure, Lisp, Erlang, technology, electronics, hacks, computer science" name="keywords" /><meta content="Yes Mom, I *do* robots." name="description" /></head><body><nav class="navbar navbar-default navbar-fixed-top"><div class="container"><div class="navbar-header"><button class="navbar-toggle navbar-brand pull-left" data-target="#navbar-responsive-collapse" data-toggle="collapse" type="button"><div><img src="../media/logo.svg" />idorobots.org</div></button><div class="hidden-xs"><a class="navbar-brand" href=".."><div><img src="../media/logo.svg" />idorobots.org</div></a></div></div><div class="collapse navbar-collapse navbar-right" id="navbar-responsive-collapse"><ul class="nav navbar-nav"><li><a href="https://github.com/Idorobots"><i class="fa fa-github"></i> GitHub</a></li><li><a href="../resume.html"><i class="fa fa-trophy"></i> Resumé</a></li><li><a href="../contact.html"><i class="fa fa-comment"></i> Contact</a></li><li class="divider hidden-sm hidden-md hidden-lg"></li><li class="hidden-sm hidden-md hidden-lg"><a href=".."><i class="fa fa-home"></i> Home</a></li><li class="hidden-sm hidden-md hidden-lg"><a href="../archives.html"><i class="fa fa-archive"></i> Archives</a></li><li class="hidden-sm hidden-md hidden-lg"><a href="../tags/index.html"><i class="fa fa-tags"></i> Tag Cloud</a></li><li class="hidden-sm hidden-md hidden-lg"><a href="../index.xml"><i class="fa fa-feed"></i> Feed</a></li><li class="dropdown hidden-xs"><a href="#"><i class="fa fa-chevron-right"></i></a><ul class="dropdown-menu"><li><a href=".."><i class="fa fa-home"></i> Home</a></li><li><a href="../archives.html"><i class="fa fa-archive"></i> Archives</a></li><li><a href="../tags/index.html"><i class="fa fa-tags"></i> Tag Cloud</a></li><li><a href="../index.xml"><i class="fa fa-feed"></i> Feed</a></li></ul></li></ul></div></div></nav><div class="body-wrap"><article id="page"><div class="container"><header class="page-header"></header><div class="panel panel-default"><div class="panel-body"><div class="text-center"><h1>Tagged Scheme</h1></div></div></div><article><header><div class="panel panel-default"><div class="panel-body"><div class="text-center"><div class="row"><h1><a href="../entries/promise-as-a-basic-language-feature.html">Promise as a basic language feature</a></h1><p>Posted on <time>2016-11-02 00:23</time> by <a href="https://github.com/Idorobots">Idorobots</a></p><nav><a class="tag" href="../tags/actor-model.html"><span class="label label-info small">Actor Model</span></a> <a class="tag" href="../tags/cps.html"><span class="label label-info small">CPS</span></a> <a class="tag" href="../tags/lisp.html"><span class="label label-info small">Lisp</span></a> <a class="tag" href="../tags/promise.html"><span class="label label-info small">Promise</span></a> <a class="tag" href="../tags/scheme.html"><span class="label label-info small">Scheme</span></a> <a class="tag" href="../tags/benchmarks.html"><span class="label label-info small">benchmarks</span></a> <a class="tag" href="../tags/language-features.html"><span class="label label-info small">language features</span></a></nav></div></div></div></div></header><p>Just the other day, while programming in Scala, I was thinking how nice it is that Haskell hides non-strictness (a.k.a. laziness) underneath, so no obnoxious lazy stream creation/forcing needs to be done. And then it struck me: how cool would it be to treat Promises in a language the same way that Haskell treats lazy values? Would such a language even make sense? How would you program in such a language?</p><p>Let's explore! You can find all the code included in this post in a more useful form <a href='https://github.com/Idorobots/promise-based-lang'>here</a>.</p><h2><a name="promise"></a><a href="#promise">Promise</a></h2>Here's a very simple <code>Promise</code> implementation written in Scheme, with support for asynchronous resolving & error rejection, which we'll need in order to explore this weird proposition:<p><div class="row"><div class="col-xs-12 col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3"></p><pre><code class="scheme">&#40;define &#42;promises&#42; '&#40;&#41;&#41;

&#40;define &#40;make-promise value state then handle thunk&#41;
  &#40;list '&amp;promise value state then handle thunk&#41;&#41;

;; Field accessors omitted.

&#40;define &#40;promise fun&#41;
  &#40;let&#42; &#40;&#40;val '&#40;&#41;&#41;
         &#40;state 'pending&#41;
         &#40;on-resolve id&#41;
         &#40;on-reject id&#41;
         &#40;resolve &#40;lambda &#40;v&#41;
                    &#40;set! val v&#41;
                    &#40;set! state 'resolved&#41;
                    &#40;on-resolve val&#41;&#41;&#41;
         &#40;reject &#40;lambda &#40;e&#41;
                   &#40;set! val e&#41;
                   &#40;set! state 'rejected&#41;
                   &#40;on-reject val&#41;&#41;&#41;
         &#40;then &#40;lambda &#40;t&#41;
                 &#40;if &#40;equal? state 'resolved&#41;
                     &#40;t val&#41;
                     &#40;set! on-resolve t&#41;&#41;&#41;&#41;
         &#40;handle &#40;lambda &#40;h&#41;
                   &#40;if &#40;equal? state 'rejected&#41;
                       &#40;h val&#41;
                       &#40;set! on-reject h&#41;&#41;&#41;&#41;
         &#40;p &#40;make-promise &#40;lambda &#40;&#41; val&#41;
                          &#40;lambda &#40;&#41; state&#41;
                          then
                          handle
                          &#40;lambda &#40;&#41; &#40;fun resolve reject&#41;&#41;&#41;&#41;&#41;
    &#40;set! &#42;promises&#42; &#40;cons p &#42;promises&#42;&#41;&#41;
    p&#41;&#41;
</code></pre><p></div></div></p><a href="../entries/promise-as-a-basic-language-feature.html#preview-more">Continue reading <i class="fa fa-chevron-right"></i></a></article><hr /><article><header><div class="panel panel-default"><div class="panel-body"><div class="text-center"><div class="row"><h1><a href="../entries/using-a-rule-based-system-for-type-inference..html">Using a Rule-based System for type inference.</a></h1><p>Posted on <time>2016-07-18 20:23</time> by <a href="https://github.com/Idorobots">Idorobots</a></p><nav><a class="tag" href="../tags/lisp.html"><span class="label label-info small">Lisp</span></a> <a class="tag" href="../tags/prolog.html"><span class="label label-info small">Prolog</span></a> <a class="tag" href="../tags/rbs.html"><span class="label label-info small">RBS</span></a> <a class="tag" href="../tags/rete.html"><span class="label label-info small">Rete</span></a> <a class="tag" href="../tags/scheme.html"><span class="label label-info small">Scheme</span></a> <a class="tag" href="../tags/logic-programming.html"><span class="label label-info small">logic programming</span></a> <a class="tag" href="../tags/rules.html"><span class="label label-info small">rules</span></a> <a class="tag" href="../tags/type-reconstruction.html"><span class="label label-info small">type reconstruction</span></a> <a class="tag" href="../tags/type-systems.html"><span class="label label-info small">type systems</span></a></nav></div></div></div></div></header><p>Recently, I came across <a href='http://code.alehander42.me/prolog_type_systems'>this post</a> about implementing custom type systems using Prolog and it inspired me to revisit an old logic-programming-related project of mine.</p><p>About a year and a half ago I took a shot at using Prolog for type reconstruction (a.k.a. <strong>type inference</strong>), but that resulted in a load of <em>not much</em> for one reason or another. I did write <a href='https://github.com/Idorobots/rules'>this Rule-based system</a> shortly thereafter, however I did not give much thought to using it for type reconstruction. Let's change it...</p><p><div class="row"><div class="col-xs-12 col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3"></p><pre><code class="scheme">&#40;assert! &#40;: map &#40;-&gt; &#40;&#40;-&gt; &#40;?a&#41; ?b&#41; &#40;list ?a&#41;&#41; &#40;list ?b&#41;&#41;&#41;&#41;
</code></pre><p></div></div></p><a href="../entries/using-a-rule-based-system-for-type-inference..html#preview-more">Continue reading <i class="fa fa-chevron-right"></i></a></article><hr /><article><header><div class="panel panel-default"><div class="panel-body"><div class="text-center"><div class="row"><h1><a href="../entries/templated-monads_-monadic-templates_.html">Templated Monads? Monadic Templates?</a></h1><p>Posted on <time>2012-04-15 18:57</time> by <a href="https://github.com/Idorobots">Idorobots</a></p><nav><a class="tag" href="../tags/d-programming-language.html"><span class="label label-info small">D programming language</span></a> <a class="tag" href="../tags/functional-programming.html"><span class="label label-info small">Functional Programming</span></a> <a class="tag" href="../tags/scheme.html"><span class="label label-info small">Scheme</span></a> <a class="tag" href="../tags/hacks.html"><span class="label label-info small">hacks</span></a> <a class="tag" href="../tags/monads.html"><span class="label label-info small">monads</span></a> <a class="tag" href="../tags/templates.html"><span class="label label-info small">templates</span></a></nav></div></div></div></div></header><p>So, I finally found some time for a <a href='http://blog.idorobots.org/entries/template-metaranting.html'>Template Metaranting</a> follow-up post. This time let's get down to business as this one contains a fair amount of code.</p><p>Sadly, I won't rant as much but instead I'll try to show how <strong>awesome</strong> <a href='http://dlang.org/index.html'>D</a>'s templates really are. We'll write a piece of code, based on <a href='http://okmij.org/ftp/Scheme/monad-in-Scheme.html'>this Scheme implementation</a>, that is, a simple <a href='http://en.wikipedia.org/wiki/Monad_(functional_programming'>monad</a>) that we'll use to build a binary tree, with uniquely numbered nodes containing their height, without any global state (therefore <a href='http://en.wikipedia.org/wiki/Functional_programming'>purely</a>) <strong>entirely at compile time</strong>.</p><p><div style="text-align:center;"><a href="http://i3.kym-cdn.com/entries/icons/original/000/003/891/grab&#95;my&#95;boobs.jpg"></p><p>Quick Reader, grab my code!</p><p>ADVENTURE!</p><p></a></div></p><a href="../entries/templated-monads_-monadic-templates_.html#preview-more">Continue reading <i class="fa fa-chevron-right"></i></a></article><hr /><article><header><div class="panel panel-default"><div class="panel-body"><div class="text-center"><div class="row"><h1><a href="../entries/_car-__2-3__.html">(car '(2 3))</a></h1><p>Posted on <time>2011-05-07 01:10</time> by <a href="https://github.com/Idorobots">Idorobots</a></p><nav><a class="tag" href="../tags/d-programming-language.html"><span class="label label-info small">D programming language</span></a> <a class="tag" href="../tags/lisp.html"><span class="label label-info small">Lisp</span></a> <a class="tag" href="../tags/scheme.html"><span class="label label-info small">Scheme</span></a></nav></div></div></div></div></header><p>It's been a while since my last post, more than I'd wish for actually, and that is because I was hunting a man by the name Iain Buclaw on the IRC. I had to make sure he was ok with me using some of his work in this next project/post (and he obviously is, oh the kind gentleman he is).</p><p>Last time I shared some thoughts on latmab, a simple algebraic calculator, I have... commited and todays topic is somewhat related. It's a <a href='http://en.wikipedia.org/wiki/Continuation'>continuation</a> I'd say, but let's go on with the story...</p><a href="../entries/_car-__2-3__.html#preview-more">Continue reading <i class="fa fa-chevron-right"></i></a></article><hr /><div class="panel panel-default"><div class="panel-body"><div class="text-center"><h1><a href="../archives.html">Archives</a></h1></div></div></div><footer><hr /><div class="row"><div class="text-center"><div class="row"><div>Copyright © 2011-2017 Kajetan "Kajtek" Rzepecki</div><div>All writing licensed under <a href="http://creativecommons.org/licenses/by-sa/4.0/" rel="license">CC BY-SA 4.0</a>. All code released under the <a href="../media/LICENSE" rel="license">MIT license</a> unless otherwise specified.</div></div></div><div class="text-center"><p>Powered by <a href="https://github.com/Idorobots/lambda-blog">λ-blog</a>.</p></div></div></footer></div></article></div></body></html>